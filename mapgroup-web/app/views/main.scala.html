@import helper._

<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Map Group WebApp</title>
        <link rel="stylesheet" media="screen" href="@routes.Assets.versioned("stylesheets/main.css")">
        <link rel="shortcut icon" type="image/png" href="@routes.Assets.versioned("images/favicon.png")">
        <script src="@routes.Assets.versioned("javascripts/hello.js")" type="text/javascript"></script>
    </head>
    <body>
        <script type="text/javascript" charset="utf-8">
            var wsGroup = new WebSocket("ws://localhost:9000/wsGroup");
            wsGroup.onopen = function(){
              console.log("Connection stablished with MapGroupSystem!!");
            }
            wsGroup.onmessage = function(jsonGroup) {
                var group = JSON.parse(jsonGroup.data);
                var nr        = document.createElement("td");
                nr.appendChild(document.createTextNode("1"));
                var id        = document.createElement("td");
                id.appendChild(document.createTextNode(group.id));
                var date      = document.createElement("td");
                date.appendChild(document.createTextNode(group.groupDate));
                var qtd       = document.createElement("td");
                qtd.appendChild(document.createTextNode(group.elements.length));
                var perc      = document.createElement("td");
                perc.appendChild(document.createTextNode(group.percent));
                var charac    = document.createElement("td");
                charac.appendChild(document.createTextNode(group.affinities));
                var newLine    = document.createElement("tr");
                var exportButton = document.createElement("button");
                exportButton.appendChild(document.createTextNode('EXPORT GROUP'));
                exportButton.onclick = function() {
                  var a = document.createElement('a');
                  var blob = new Blob([group.elements], {'type':'application/octet-stream'});
                  a.href = window.URL.createObjectURL(blob);
                  a.download = 'export-group-' + group.id + '.txt';
                  a.click();
                }
                newLine.appendChild(nr);
                newLine.appendChild(id);
                newLine.appendChild(date);
                newLine.appendChild(qtd);
                newLine.appendChild(perc);
                newLine.appendChild(charac);
                newLine.appendChild(exportButton);
                var tableGroups = document.getElementById("table-groups");
                tableGroups.appendChild(newLine);
            };
            function wsMessage() {
              wsGroup.send("CharacGroup");
  					};
  			</script>
        <p>Map Group WebApp - Agrupamento por Características
        <a href="/addGroup"><button>add-group</button></a>
        <button onclick="wsMessage()">ws-group</button>
        <table style="width:100%" id="table-groups">
        <tr>
          <td>[#]</td>
          <td>[ID GROUP]</td>
          <td>[DATA DO AGRUPAMENTO]</td>
          <td>[QUANTIDADE DE CLIENTES]</td>
          <td>[PERCENTUAL DO TOTAL]</td>
          <td>[CARACTERISTICAS]</td>
        </tr>
      </table>
    </body>
</html>
